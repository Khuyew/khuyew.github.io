<!DOCTYPE html>
<html lang="ru" itemscope itemtype="https://schema.org/WebApplication">
<head>
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=104843405', 'ym');
    
        ym(104843405, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/104843405" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QQKXYHS18Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-QQKXYHS18Q');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#121212">
    
    <!-- SEO Meta Tags -->
    <title>KHAI ‚Äî –ü–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π AI —á–∞—Ç</title>
    <meta name="description" content="KHAI ‚Äî –ø–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≥–æ–ª–æ—Å–∞. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π AI-—á–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∞–π–ª–æ–≤ –∏ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º">
    <meta name="keywords" content="KHAI, –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò, –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, AI –ø–æ–º–æ—â–Ω–∏–∫, —á–∞—Ç —Å –ò–ò, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≥–æ–ª–æ—Å–æ–≤–æ–π –ò–ò, –ò–ò –ë–µ–ª–∞—Ä—É—Å—å">
    <meta name="author" content="KHAI Team">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="googlebot" content="index, follow">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="KHAI Assistant">
    <meta property="og:title" content="KHAI ‚Äî –ü–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫">
    <meta property="og:description" content="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≥–æ–ª–æ—Å–∞. –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–æ–≤, –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞, –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞">
    <meta property="og:image" content="./assets/logo.png">
    <meta property="og:url" content="./">
    <meta property="og:locale" content="ru_RU">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="KHAI ‚Äî –ü–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫">
    <meta name="twitter:description" content="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≥–æ–ª–æ—Å–∞">
    <meta name="twitter:image" content="./assets/logo.png">
    <meta name="twitter:site" content="@khai_assistant">
    
    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "KHAI Assistant",
        "url": "./",
        "description": "–ü–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≥–æ–ª–æ—Å–∞",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "permissions": "microphone",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "KHAI",
            "url": "./"
        }
    }
    </script>

    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json" crossorigin="use-credentials">
    <link rel="icon" type="image/x-icon" href="./assets/favicon.ico">
    <link rel="apple-touch-icon" href="./assets/logo.png">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/dist/tabler-icons.min.css" as="style">
    <link rel="preload" href="./styles.css" as="style">
    <link rel="preload" href="./script.js" as="script">
    
    <!-- Styles -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/dist/tabler-icons.min.css">
    <link rel="stylesheet" href="./styles.css">
    
    <!-- Puter AI SDK -->
    <script src="https://js.puter.com/v2/"></script>
</head>
<body>
    <!-- Onboarding Guide Overlay -->
    <div class="guide-overlay" id="guideOverlay">
        <div class="guide-container">
            <div class="guide-header">
                <h2>üéØ –û–±—É—á–µ–Ω–∏–µ KHAI Assistant</h2>
                <p>–ü—Ä–æ–π–¥–∏—Ç–µ –∫—Ä–∞—Ç–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –æ—Å–≤–æ–∏—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
            </div>
            
            <div class="guide-content">
                <!-- Step 1: Introduction -->
                <div class="guide-step active" id="guideStep1">
                    <div class="guide-highlight" id="guideHighlight1"></div>
                    <div class="guide-tooltip" id="guideTooltip1">
                        <h3>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ KHAI!</h3>
                        <p>–≠—Ç–æ –≤–∞—à –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫. –î–∞–≤–∞–π—Ç–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.</p>
                        <div class="guide-actions">
                            <button class="guide-btn primary" onclick="nextGuideStep()">
                                –î–∞–ª–µ–µ <i class="ti ti-arrow-right"></i>
                            </button>
                            <button class="guide-btn secondary" onclick="skipGuide()">
                                –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Chat Input -->
                <div class="guide-step" id="guideStep2">
                    <div class="guide-highlight" id="guideHighlight2"></div>
                    <div class="guide-tooltip" id="guideTooltip2">
                        <h3>üí¨ –û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞</h3>
                        <p>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ò–ò. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Enter –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–ª–∏ –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏.</p>
                        <div class="guide-actions">
                            <button class="guide-btn secondary" onclick="prevGuideStep()">
                                <i class="ti ti-arrow-left"></i> –ù–∞–∑–∞–¥
                            </button>
                            <button class="guide-btn primary" onclick="nextGuideStep()">
                                –î–∞–ª–µ–µ <i class="ti ti-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: File Upload -->
                <div class="guide-step" id="guideStep3">
                    <div class="guide-highlight" id="guideHighlight3"></div>
                    <div class="guide-tooltip" id="guideTooltip3">
                        <h3>üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤</h3>
                        <p>–ù–∞–∂–º–∏—Ç–µ —ç—Ç—É –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–ª–∏ —Ñ–∞–π–ª—ã –∫–æ–¥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.</p>
                        <div class="guide-actions">
                            <button class="guide-btn secondary" onclick="prevGuideStep()">
                                <i class="ti ti-arrow-left"></i> –ù–∞–∑–∞–¥
                            </button>
                            <button class="guide-btn primary" onclick="nextGuideStep()">
                                –î–∞–ª–µ–µ <i class="ti ti-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Mode Selection -->
                <div class="guide-step" id="guideStep4">
                    <div class="guide-highlight" id="guideHighlight4"></div>
                    <div class="guide-tooltip" id="guideTooltip4">
                        <h3>üéõÔ∏è –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã</h3>
                        <p>–ü–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ—Å—å –º–µ–∂–¥—É –æ–±—ã—á–Ω—ã–º —á–∞—Ç–æ–º, –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –≥–æ–ª–æ—Å–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–∏—Ö –∑–∞–¥–∞—á.</p>
                        <div class="guide-actions">
                            <button class="guide-btn secondary" onclick="prevGuideStep()">
                                <i class="ti ti-arrow-left"></i> –ù–∞–∑–∞–¥
                            </button>
                            <button class="guide-btn primary" onclick="nextGuideStep()">
                                –î–∞–ª–µ–µ <i class="ti ti-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Model Selection -->
                <div class="guide-step" id="guideStep5">
                    <div class="guide-highlight" id="guideHighlight5"></div>
                    <div class="guide-tooltip" id="guideTooltip5">
                        <h3>ü§ñ –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –ò–ò</h3>
                        <p>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é –º–æ–¥–µ–ª—å –ò–ò –¥–ª—è –≤–∞—à–∏—Ö –∑–∞–¥–∞—á - –æ—Ç –±—ã—Å—Ç—Ä—ã—Ö –¥–æ —Å–∞–º—ã—Ö –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö.</p>
                        <div class="guide-actions">
                            <button class="guide-btn secondary" onclick="prevGuideStep()">
                                <i class="ti ti-arrow-left"></i> –ù–∞–∑–∞–¥
                            </button>
                            <button class="guide-btn primary" onclick="nextGuideStep()">
                                –î–∞–ª–µ–µ <i class="ti ti-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Chat Management -->
                <div class="guide-step" id="guideStep6">
                    <div class="guide-highlight" id="guideHighlight6"></div>
                    <div class="guide-tooltip" id="guideTooltip6">
                        <h3>üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏</h3>
                        <p>–û—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —á–∞—Ç–æ–≤, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–µ–π.</p>
                        <div class="guide-actions">
                            <button class="guide-btn secondary" onclick="prevGuideStep()">
                                <i class="ti ti-arrow-left"></i> –ù–∞–∑–∞–¥
                            </button>
                            <button class="guide-btn primary" onclick="completeGuide()">
                                –ù–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å! <i class="ti ti-rocket"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress -->
            <div class="guide-progress">
                <div class="guide-progress-dot active" data-step="1"></div>
                <div class="guide-progress-dot" data-step="2"></div>
                <div class="guide-progress-dot" data-step="3"></div>
                <div class="guide-progress-dot" data-step="4"></div>
                <div class="guide-progress-dot" data-step="5"></div>
                <div class="guide-progress-dot" data-step="6"></div>
            </div>
        </div>
    </div>

    <!-- Preloader -->
    <div class="preloader" id="preloader">
        <div class="preloader-content">
            <div class="logo-animation">
                <svg width="80" height="80" viewBox="0 0 100 100">
                    <defs>
                        <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#0099FF"/>
                            <stop offset="100%" stop-color="#0066FF"/>
                        </linearGradient>
                    </defs>
                    <path class="logo-path" d="M50 10 L90 30 L90 70 L50 90 L10 70 L10 30 Z M50 30 L70 40 L70 60 L50 70 L30 60 L30 40 Z" fill="url(#logoGradient)"/>
                </svg>
            </div>
            <div class="preloader-spinner"></div>
            <p class="preloader-text">–ó–∞–≥—Ä—É–∑–∫–∞ KHAI Assistant...</p>
        </div>
    </div>

    <!-- 404 Page (hidden by default) -->
    <div class="page-404" id="page404" style="display: none;">
        <div class="error-container">
            <div class="logo-animation">
                <svg width="120" height="120" viewBox="0 0 100 100">
                    <defs>
                        <linearGradient id="errorGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#0099FF"/>
                            <stop offset="100%" stop-color="#0066FF"/>
                        </linearGradient>
                    </defs>
                    <path class="logo-path" d="M50 10 L90 30 L90 70 L50 90 L10 70 L10 30 Z M50 30 L70 40 L70 60 L50 70 L30 60 L30 40 Z" fill="url(#errorGradient)"/>
                </svg>
            </div>
            <h1>404 - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</h1>
            <p>–ó–∞–ø—Ä–æ—à–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –±—ã–ª–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞.</p>
            <button class="error-btn" id="errorBackBtn">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="app-container" id="appContainer">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo-container">
                    <div class="logo" id="logoBtn">
                        <svg width="36" height="36" viewBox="0 0 100 100">
                            <defs>
                                <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" stop-color="#0099FF"/>
                                    <stop offset="100%" stop-color="#0066FF"/>
                                </linearGradient>
                            </defs>
                            <path class="logo-path" d="M50 10 L90 30 L90 70 L50 90 L10 70 L10 30 Z M50 30 L70 40 L70 60 L50 70 L30 60 L30 40 Z" fill="url(#headerGradient)"/>
                        </svg>
                    </div>
                </div>
                
                <button class="control-btn model-select-btn" id="modelSelectBtn" title="–í—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –ò–ò">
                    <i class="ti ti-brain"></i>
                </button>
                
                <div class="header-search-container">
                    <div class="search-wrapper">
                        <i class="ti ti-search"></i>
                        <input type="text" id="headerSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç—É..." aria-label="–ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞">
                        <button class="search-clear" id="headerSearchClear" style="display: none;" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫">
                            <i class="ti ti-x"></i>
                        </button>
                    </div>
                </div>
                
                <div class="header-controls">
                    <button class="control-btn" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <i class="ti ti-moon"></i>
                    </button>
                    <button class="control-btn menu-toggle" id="menuToggle" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">
                        <i class="ti ti-menu-2"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Chat Area -->
        <main class="chat-main">
            <div class="messages-container" id="messagesContainer" aria-live="polite">
                <!-- Messages will be loaded here -->
            </div>

            <!-- Minimap & Navigation -->
            <div class="chat-minimap-container">
                <div class="minimap-header">
                    <button class="nav-btn theme-minimap-btn" id="themeMinimapToggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <i class="ti ti-moon"></i>
                    </button>
                </div>
                <div class="chat-minimap" id="chatMinimap">
                    <div class="minimap-content" id="minimapContent"></div>
                    <div class="minimap-viewport" id="minimapViewport"></div>
                </div>
                <div class="minimap-navigation">
                    <button class="nav-btn" id="scrollToLastAI" title="–ö –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –æ—Ç–≤–µ—Ç—É –ò–ò">
                        <i class="ti ti-arrow-up"></i>
                    </button>
                    <button class="nav-btn" id="scrollToBottom" title="–ö –Ω–∏–∑—É —á–∞—Ç–∞">
                        <i class="ti ti-arrow-down"></i>
                    </button>
                </div>
            </div>
        </main>

        <!-- Input Section -->
        <div class="input-section" id="inputSection">
            <div class="mode-indicator">
                <i class="ti ti-message"></i> –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º
            </div>
            
            <div class="input-wrapper">
                <button class="attach-btn" id="attachFileBtn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">
                    <i class="ti ti-plus"></i>
                    <input type="file" id="fileInput" accept="image/*,.txt,.md,.html,.css,.js,.json,.py,.java,.cpp,.c,.cs,.php,.rb,.go,.swift,.kt,.scala,.rs,.xml,.csv,.yaml,.yml" multiple style="display: none;">
                </button>
                
                <textarea 
                    id="userInput" 
                    placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ..." 
                    autocomplete="off" 
                    rows="1"
                    maxlength="4000"
                    aria-label="–ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è"
                ></textarea>
                
                <div class="input-controls">
                    <button class="input-btn" id="clearInputBtn" title="–û—á–∏—Å—Ç–∏—Ç—å –≤–≤–æ–¥" style="display: none;">
                        <i class="ti ti-x"></i>
                    </button>
                    <button class="input-btn" id="voiceInputBtn" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥">
                        <i class="ti ti-microphone"></i>
                    </button>
                    <button class="send-btn" id="sendBtn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
                        <i class="ti ti-send"></i>
                    </button>
                </div>
            </div>

            <div class="attached-files" id="attachedFiles"></div>

            <div class="action-buttons">
                <button class="action-btn mode-btn active" id="normalModeBtn">
                    <i class="ti ti-message"></i>
                    <span class="btn-text">–û–±—ã—á–Ω—ã–π</span>
                </button>
                <button class="action-btn mode-btn" id="generateVoiceBtn" disabled title="–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ">
                    <i class="ti ti-microphone"></i>
                    <span class="btn-text">–ì–æ–ª–æ—Å</span>
                </button>
                <button class="action-btn mode-btn" id="generateImageBtn" disabled title="–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ">
                    <i class="ti ti-photo"></i>
                    <span class="btn-text">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                </button>
                <button class="action-btn mode-btn" id="generateVideoBtn">
                    <i class="ti ti-video"></i>
                    <span class="btn-text">–í–∏–¥–µ–æ</span>
                </button>
            </div>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <div class="current-chat-info">
                    <i class="ti ti-message"></i>
                    <span id="currentChatName">–ù–æ–≤—ã–π —á–∞—Ç</span>
                </div>
                
                <div class="connection-status">
                    <i class="ti ti-circle"></i>
                    <span id="connectionStatusText">–ü–æ–¥–∫–ª—é—á–µ–Ω–æ</span>
                </div>
                
                <div class="footer-controls">
                    <button class="footer-btn" id="helpBtn" title="–ü–æ–º–æ—â—å">
                        <i class="ti ti-help"></i>
                    </button>
                    <button class="footer-btn" id="downloadChatBtn" title="–°–∫–∞—á–∞—Ç—å —á–∞—Ç">
                        <i class="ti ti-download"></i>
                    </button>
                    <button class="footer-btn" id="clearChatBtn" title="–û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç">
                        <i class="ti ti-trash"></i>
                    </button>
                </div>
            </div>
        </footer>
    </div>

    <!-- Sidebar Menu -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="sidebar-menu" id="sidebarMenu">
        <div class="sidebar-header">
            <div class="sidebar-header-content">
                <div class="sidebar-logo">
                    <svg width="40" height="40" viewBox="0 0 100 100">
                        <defs>
                            <linearGradient id="sidebarGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#0099FF"/>
                                <stop offset="100%" stop-color="#0066FF"/>
                            </linearGradient>
                        </defs>
                        <path class="logo-path" d="M50 10 L90 30 L90 70 L50 90 L10 70 L10 30 Z M50 30 L70 40 L70 60 L50 70 L30 60 L30 40 Z" fill="url(#sidebarGradient)"/>
                    </svg>
                </div>
                <h3>KHAI <span class="beta-badge">BETA</span></h3>
            </div>
            <button class="sidebar-close" id="sidebarClose">
                <i class="ti ti-x"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <div class="sidebar-search-container">
                <div class="search-wrapper">
                    <i class="ti ti-search"></i>
                    <input type="text" id="sidebarSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç–∞–º..." aria-label="–ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç–∞–º">
                    <button class="search-clear" id="sidebarSearchClear" style="display: none;" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫">
                        <i class="ti ti-x"></i>
                    </button>
                </div>
            </div>

            <div class="sidebar-section">
                <h4><i class="ti ti-messages"></i> –ú–æ–∏ —á–∞—Ç—ã</h4>
                <div class="chat-list" id="chatList"></div>
                <div class="chat-management-buttons">
                    <button class="sidebar-btn primary" id="newChatBtn">
                        <i class="ti ti-plus"></i> –ù–æ–≤—ã–π —á–∞—Ç
                    </button>
                    <button class="sidebar-btn" id="importChatBtn">
                        <i class="ti ti-upload"></i> –ò–º–ø–æ—Ä—Ç —á–∞—Ç–∞
                    </button>
                    <button class="sidebar-btn danger" id="deleteAllChatsBtn">
                        <i class="ti ti-trash"></i> –£–¥–∞–ª–∏—Ç—å –≤—Å–µ
                    </button>
                </div>
            </div>

            <div class="sidebar-section">
                <h4><i class="ti ti-brain"></i> –ú–æ–¥–µ–ª—å –ò–ò</h4>
                <div class="current-model-info">
                    <span id="currentModelInfo">GPT-5 Nano</span>
                    <span class="connection-status" id="connectionStatus">‚úÖ –û–Ω–ª–∞–π–Ω</span>
                </div>
            </div>

            <div class="sidebar-section">
                <h4><i class="ti ti-info-circle"></i> –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h4>
                <div class="about-content">
                    <div class="about-item">
                        <strong>KHAI Assistant</strong>
                        <span>–ü–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫</span>
                    </div>
                    <div class="about-item">
                        <strong>–í–µ—Ä—Å–∏—è</strong>
                        <span>2.1.0</span>
                    </div>
                    <div class="about-item">
                        <strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ</strong>
                        <span id="appVersionDate">2024</span>
                    </div>
                </div>
            </div>

            <div class="sidebar-links">
                <button class="sidebar-btn" id="guideBtn" style="margin-bottom: 15px;">
                    <i class="ti ti-presentation"></i> –ü—Ä–æ–π—Ç–∏ –æ–±—É—á–µ–Ω–∏–µ
                </button>
                
                <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;">
                    <a href="https://khai.by/docs" target="_blank" class="sidebar-link">
                        –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
                    </a>
                    <a href="https://khai.by/support" target="_blank" class="sidebar-link">
                        –ü–æ–¥–¥–µ—Ä–∂–∫–∞
                    </a>
                    <a href="mailto:khuyew@proton.me" class="sidebar-link">
                        –°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ
                    </a>
                </div>
                
                <!-- LiveInternet Counter -->
                <div style="margin-bottom: 20px; display: flex; justify-content: center;">
                    <!--LiveInternet counter--><a href="https://www.liveinternet.ru/click"
                    target="_blank"><img id="licntB611" width="88" height="31" style="border:0" 
                    title="LiveInternet: –ø–æ–∫–∞–∑–∞–Ω–æ —á–∏—Å–ª–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∏ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∑–∞ 24 —á–∞—Å–∞"
                    src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"
                    alt=""/></a><script>(function(d,s){d.getElementById("licntB611").src=
                    "https://counter.yadro.ru/hit?t52.6;r"+escape(d.referrer)+
                    ((typeof(s)=="undefined")?"":";s"+s.width+"*"+s.height+"*"+
                    (s.colorDepth?s.colorDepth:s.pixelDepth))+";u"+escape(d.URL)+
                    ";h"+escape(d.title.substring(0,150))+";"+Math.random()})
                    (document,screen)</script><!--/LiveInternet-->

                    <!-- Yandex.Metrika informer --> <a href="https://metrika.yandex.ru/stat/?id=104843405&amp;from=informer" target="_blank" rel="nofollow">     <img src="https://metrika-informer.com/informer/104843405/3_1_FFFFFFFF_EFEFEFFF_0_pageviews"          style="width:88px; height:31px; border:0;"          alt="–Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞"          title="–Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞: –¥–∞–Ω–Ω—ã–µ –∑–∞ —Å–µ–≥–æ–¥–Ω—è (–ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –≤–∏–∑–∏—Ç—ã –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏)"         class="ym-advanced-informer" data-cid="104843405" data-lang="ru"/> </a> <!-- /Yandex.Metrika informer -->  <!-- Yandex.Metrika counter --> <script type="text/javascript">     (function(m,e,t,r,i,k,a){         m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};         m[i].l=1*new Date();         for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}         k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)     })(window, document,'script','https://mc.webvisor.org/metrika/tag_ww.js', 'ym');      ym(104843405, 'init', {webvisor:true, trackHash:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true}); </script>  <!-- /Yandex.Metrika counter -->   
                </div>
                
                <a href="https://khai.by/github" target="_blank" class="github-link">
                    <i class="ti ti-brand-github"></i>
                </a>
                
                <p class="sidebar-copyright">
                    ¬© 2025 KHAI, –ë–µ–ª–∞—Ä—É—Å—å.<br>
                    –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã!
                </p>
            </div>
        </div>
    </div>

    <!-- Edit Chat Modal -->
    <div class="modal-overlay" id="editChatModal">
        <div class="modal">
            <div class="modal-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞</h3>
                <button class="modal-close" id="editChatModalClose">
                    <i class="ti ti-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-input-wrapper">
                    <input type="text" id="editChatNameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞..." maxlength="16" class="modal-input">
                    <button class="modal-clear-input" id="modalClearInput" style="display: none;">
                        <i class="ti ti-x"></i>
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" id="editChatModalCancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn primary" id="editChatModalSave">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Model Selection Modal -->
    <div class="modal-overlay" id="modelModalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h3>–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –ò–ò</h3>
                <button class="modal-close" id="modelModalClose">
                    <i class="ti ti-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="model-list" id="modelList"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" id="modelModalCancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn primary" id="modelModalConfirm">–í—ã–±—Ä–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Video Generation Modal -->
    <div class="modal-overlay" id="videoModalOverlay">
        <div class="modal video-modal">
            <div class="modal-header">
                <h3>üé¨ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ</h3>
                <button class="modal-close" id="videoModalClose">
                    <i class="ti ti-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="video-preview" id="videoPreview">
                    <div class="video-placeholder">
                        <i class="ti ti-video"></i>
                        <p>–í–∏–¥–µ–æ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∑–¥–µ—Å—å</p>
                    </div>
                </div>
                <div class="video-controls">
                    <div class="video-param">
                        <label for="videoDuration">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å–µ–∫—É–Ω–¥—ã):</label>
                        <select id="videoDuration">
                            <option value="4">4 —Å–µ–∫—É–Ω–¥—ã</option>
                            <option value="8" selected>8 —Å–µ–∫—É–Ω–¥</option>
                            <option value="12">12 —Å–µ–∫—É–Ω–¥</option>
                            <option value="16">16 —Å–µ–∫—É–Ω–¥</option>
                        </select>
                    </div>
                    <div class="video-param">
                        <label for="videoResolution">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:</label>
                        <select id="videoResolution">
                            <option value="1280x720" selected>1280x720 (HD)</option>
                            <option value="1920x1080">1920x1080 (Full HD)</option>
                        </select>
                    </div>
                </div>
                <div class="video-prompt">
                    <textarea id="videoPromptInput" placeholder="–û–ø–∏—à–∏—Ç–µ —Å—Ü–µ–Ω—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ... –ù–∞–ø—Ä–∏–º–µ—Ä: '–ö–æ—Å–º–æ–Ω–∞–≤—Ç –ª–µ—Ç–∏—Ç —á–µ—Ä–µ–∑ –≥–∞–ª–∞–∫—Ç–∏–∫—É –≤ —Å—Ç–∏–ª–µ –∞–Ω–∏–º–µ'"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" id="videoModalCancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn primary" id="videoModalGenerate">
                    <i class="ti ti-player-play"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="./script.js"></script>

    <!-- PWA Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ', registration);
                    })
                    .catch(error => {
                        console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ServiceWorker: ', error);
                    });
            });
        }
    </script>
</body>
</html>
