<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KHAI ‚Äî –ü–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò-—á–∞—Ç</title>
    <meta name="description" content="KHAI - –ø–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π AI-–ø–æ–º–æ—â–Ω–∏–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≥–æ–ª–æ—Å–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π">
    <meta name="theme-color" content="#0f0f23">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/app.webmanifest">
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#0099ff">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css" as="style">
    <link rel="preload" href="styles.css" as="style">
    
    <!-- Styles -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" media="(prefers-color-scheme: dark)">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Puter AI SDK -->
    <script src="https://js.puter.com/v2/" defer></script>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">KHAI</div>
                    <div class="subtitle">–ü–µ—Ä–≤—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –ò–ò</div>
                </div>
                <div class="header-controls">
                    <select class="model-select" id="modelSelect" aria-label="–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –ò–ò">
                        <option value="gpt-5-nano">GPT-5 Nano</option>
                        <option value="o3-mini">O3 Mini</option>
                        <option value="deepseek-chat">DeepSeek Chat</option>
                        <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                        <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                        <option value="gemini-1.5-flash">Gemini 1.5 Flash</option>
                        <option value="grok-beta">xAI Grok</option>
                    </select>
                    <button class="control-btn" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <i class="ti ti-moon" aria-hidden="true"></i>
                    </button>
                    <button class="control-btn menu-toggle" id="menuToggle" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">
                        <i class="ti ti-menu-2" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </header>

        <main class="chat-main" role="main">
            <div class="messages-container" id="messagesContainer" aria-live="polite" aria-atomic="false">
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <div class="input-section" role="form">
                <div class="input-wrapper">
                    <button class="attach-btn" id="attachFileBtn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" aria-label="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                        <i class="ti ti-plus" aria-hidden="true"></i>
                    </button>
                    
                    <textarea 
                        id="userInput" 
                        placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ..." 
                        autocomplete="off" 
                        rows="1"
                        aria-label="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
                        maxlength="4000"
                    ></textarea>
                    
                    <div class="input-controls">
                        <button class="input-btn" id="clearInputBtn" title="–û—á–∏—Å—Ç–∏—Ç—å –≤–≤–æ–¥" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –≤–≤–æ–¥">
                            <i class="ti ti-x" aria-hidden="true"></i>
                        </button>
                        <button class="input-btn" id="voiceInputBtn" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥" aria-label="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥">
                            <i class="ti ti-microphone" aria-hidden="true"></i>
                        </button>
                        <button class="send-btn" id="sendBtn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
                            <i class="ti ti-send" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>

                <div class="attached-files" id="attachedFiles" aria-live="polite">
                    <!-- –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã -->
                </div>

                <div class="action-buttons">
                    <button class="action-btn" id="helpBtn" aria-label="–ü–æ–º–æ—â—å">
                        <i class="ti ti-help" aria-hidden="true"></i>
                        –ü–æ–º–æ—â—å
                    </button>
                    <button class="action-btn" id="clearChatBtn" aria-label="–û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç">
                        <i class="ti ti-trash" aria-hidden="true"></i>
                        –û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç
                    </button>
                    <button class="action-btn" id="exportChatBtn" aria-label="–≠–∫—Å–ø–æ—Ä—Ç —á–∞—Ç–∞">
                        <i class="ti ti-download" aria-hidden="true"></i>
                        –≠–∫—Å–ø–æ—Ä—Ç
                    </button>
                    <button class="action-btn" id="generateVoiceBtn" aria-label="–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ–ª–æ—Å–∞">
                        <i class="ti ti-microphone" aria-hidden="true"></i>
                        –ì–æ–ª–æ—Å
                    </button>
                </div>
            </div>
        </main>

        <footer class="app-footer" role="contentinfo">
            <div class="footer-content">
                <div class="current-chat-info">
                    <i class="ti ti-message" aria-hidden="true"></i>
                    <span id="currentChatName">–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</span>
                </div>
                <div class="connection-status" id="connectionStatus">
                    <i class="ti ti-wifi" aria-hidden="true"></i>
                    <span>–û–Ω–ª–∞–π–Ω</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <input type="file" id="fileInput" accept="image/*" multiple style="display: none;" aria-hidden="true">
    <canvas id="imageCanvas" style="display: none;" aria-hidden="true"></canvas>

    <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
    <div class="sidebar-menu" id="sidebarMenu" role="dialog" aria-label="–ú–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" aria-modal="true">
        <div class="sidebar-header">
            <h3>–ú–µ–Ω—é KHAI</h3>
            <button class="sidebar-close" id="sidebarClose" aria-label="–ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é">
                <i class="ti ti-x" aria-hidden="true"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <div class="sidebar-section">
                <h4><i class="ti ti-message" aria-hidden="true"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏</h4>
                <div class="chat-list" id="chatList" role="list">
                    <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ -->
                </div>
                <button class="sidebar-btn primary" id="newChatBtn">
                    <i class="ti ti-plus" aria-hidden="true"></i> –ù–æ–≤—ã–π —á–∞—Ç
                </button>
            </div>
            
            <div class="sidebar-section">
                <h4><i class="ti ti-settings" aria-hidden="true"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
                <button class="sidebar-btn" id="settingsBtn">
                    <i class="ti ti-adjustments" aria-hidden="true"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                </button>
                <button class="sidebar-btn" id="dataManagementBtn">
                    <i class="ti ti-database" aria-hidden="true"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
                </button>
            </div>
            
            <div class="sidebar-section">
                <h4><i class="ti ti-info-circle" aria-hidden="true"></i> –û –ø—Ä–æ–≥—Ä–∞–º–º–µ</h4>
                <div class="about-content">
                    <div class="about-item">
                        <strong>üáßüáæ –°–¥–µ–ª–∞–Ω–æ –≤ –ë–µ–ª–∞—Ä—É—Å–∏</strong>
                        <span>–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –±–µ–ª–æ—Ä—É—Å—Å–∫–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</span>
                    </div>
                    <div class="about-item">
                        <strong>üîí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</strong>
                        <span>–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ</span>
                    </div>
                    <div class="about-item">
                        <strong>üåê –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</strong>
                        <span>PWA ‚Ä¢ Web AI ‚Ä¢ Speech API ‚Ä¢ IndexedDB</span>
                    </div>
                    <div class="about-item">
                        <strong>üîÑ –í–µ—Ä—Å–∏—è</strong>
                        <span>KHAI v3.0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π -->
    <div class="sidebar-overlay" id="sidebarOverlay" aria-hidden="true"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="modal" id="settingsModal" role="dialog" aria-labelledby="settingsTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="settingsTitle">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ KHAI</h3>
                <button class="modal-close" id="settingsClose" aria-label="–ó–∞–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏">
                    <i class="ti ti-x" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="autoSpeech">–ê–≤—Ç–æ-–æ–∑–≤—É—á–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤</label>
                    <input type="checkbox" id="autoSpeech" class="toggle-switch">
                </div>
                <div class="setting-group">
                    <label for="streaming">–ü–æ—Ç–æ–∫–æ–≤—ã–π —Ä–µ–∂–∏–º –æ—Ç–≤–µ—Ç–æ–≤</label>
                    <input type="checkbox" id="streaming" class="toggle-switch" checked>
                </div>
                <div class="setting-group">
                    <label for="saveHistory">–°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–æ–≤</label>
                    <input type="checkbox" id="saveHistory" class="toggle-switch" checked>
                </div>
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="app.js" type="module"></script>
</body>
</html>
