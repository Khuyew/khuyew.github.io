<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>KHAI Pro - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI –ß–∞—Ç-–ø–æ–º–æ—â–Ω–∏–∫</title>
    <meta name="description" content="–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≥–æ–ª–æ—Å–∞, –∞–Ω–∞–ª–∏–∑–æ–º —Ñ–∞–π–ª–æ–≤ –∏ –º–Ω–æ–≥–æ–º –¥—Ä—É–≥–æ–º">
    <meta name="theme-color" content="#0f0f23">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.webmanifest">
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Puter AI SDK -->
    <script src="https://js.puter.com/v2/"></script>
</head>
<body>
    <div class="app-container">
        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <header class="app-header">
            <div class="header-content">
                <!-- –õ–æ–≥–æ—Ç–∏–ø –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ -->
                <div class="logo-container">
                    <div class="logo" id="logoBtn">
                        <img src="./logo.png" alt="KHAI Pro Logo" onerror="this.style.display='none'">
                    </div>
                    <span class="app-name">KHAI Pro</span>
                </div>
                
                <!-- –¶–µ–Ω—Ç—Ä: –ø–æ–∏—Å–∫ –∏ —Å—Ç–∞—Ç—É—Å -->
                <div class="header-center">
                    <div class="header-search-container">
                        <div class="search-wrapper">
                            <i class="ti ti-search"></i>
                            <input type="text" id="headerSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç—É...">
                            <button class="search-clear" id="headerSearchClear" style="display: none;">
                                <i class="ti ti-x"></i>
                            </button>
                        </div>
                    </div>
                    <div class="connection-status" id="connectionStatus">
                        <i class="ti ti-wifi"></i>
                        <span>–û–Ω–ª–∞–π–Ω</span>
                    </div>
                </div>
                
                <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
                <div class="header-controls">
                    <button class="control-btn" id="fullscreenToggle" title="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω">
                        <i class="ti ti-arrows-maximize"></i>
                    </button>
                    <button class="control-btn" id="themeToggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <i class="ti ti-moon"></i>
                    </button>
                    <button class="control-btn model-select-btn" id="modelSelectBtn" title="–í—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –ò–ò">
                        <i class="ti ti-brain"></i>
                    </button>
                    <button class="control-btn menu-toggle" id="menuToggle">
                        <i class="ti ti-menu-2"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ -->
        <main class="chat-main">
            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π -->
            <div class="messages-container" id="messagesContainer">
                <!-- Welcome message will be added here -->
            </div>

            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π -->
            <div class="chat-sidebar">
                <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                <div class="quick-actions">
                    <button class="quick-btn" id="quickNewChat" title="–ù–æ–≤—ã–π —á–∞—Ç">
                        <i class="ti ti-plus"></i>
                    </button>
                    <button class="quick-btn" id="quickDownload" title="–°–∫–∞—á–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é">
                        <i class="ti ti-download"></i>
                    </button>
                    <button class="quick-btn" id="quickSettings" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
                        <i class="ti ti-settings"></i>
                    </button>
                </div>

                <!-- –ú–∏–Ω–∏-–∫–∞—Ä—Ç–∞ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
                <div class="minimap-section">
                    <div class="minimap-header">
                        <span>–ù–∞–≤–∏–≥–∞—Ü–∏—è</span>
                        <button class="minimap-toggle" id="minimapToggle" title="–°–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–∫–∞—Ä—Ç—É">
                            <i class="ti ti-chevron-up"></i>
                        </button>
                    </div>
                    <div class="chat-minimap-container" id="minimapContainer">
                        <div class="chat-minimap" id="chatMinimap">
                            <div class="minimap-content" id="minimapContent"></div>
                            <div class="minimap-viewport" id="minimapViewport"></div>
                        </div>
                        <div class="minimap-navigation">
                            <button class="nav-btn" id="scrollToTop" title="–ö –Ω–∞—á–∞–ª—É">
                                <i class="ti ti-arrow-bar-to-up"></i>
                            </button>
                            <button class="nav-btn" id="scrollToLastAI" title="–ö –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –æ—Ç–≤–µ—Ç—É –ò–ò">
                                <i class="ti ti-arrow-up"></i>
                            </button>
                            <button class="nav-btn" id="scrollToBottom" title="–ö –Ω–∏–∑—É">
                                <i class="ti ti-arrow-down"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∞—Ç–∞ -->
                <div class="chat-stats">
                    <div class="stat-item">
                        <i class="ti ti-message"></i>
                        <span id="messageCount">0 —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                    </div>
                    <div class="stat-item">
                        <i class="ti ti-clock"></i>
                        <span id="chatDuration">0 –º–∏–Ω</span>
                    </div>
                </div>
            </div>
        </main>

        <!-- –û–±–ª–∞—Å—Ç—å –≤–≤–æ–¥–∞ -->
        <div class="input-section" id="inputSection">
            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ -->
            <div class="mode-indicator" id="modeIndicator">
                <span id="currentModeText">–û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º</span>
            </div>

            <div class="input-wrapper">
                <!-- –ö–Ω–æ–ø–∫–∏ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ -->
                <div class="attach-buttons">
                    <button class="attach-btn" id="attachImageBtn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                        <i class="ti ti-photo"></i>
                    </button>
                    <button class="attach-btn" id="attachFileBtn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">
                        <i class="ti ti-file"></i>
                    </button>
                    <input type="file" id="fileInput" accept="image/*,text/*,.txt,.pdf,.doc,.docx,.json,.md" multiple style="display: none;">
                </div>
                
                <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ -->
                <div class="input-area">
                    <textarea 
                        id="userInput" 
                        placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ..." 
                        autocomplete="off" 
                        rows="1"
                        maxlength="8000"
                    ></textarea>
                    
                    <div class="input-controls">
                        <button class="input-btn" id="clearInputBtn" title="–û—á–∏—Å—Ç–∏—Ç—å –≤–≤–æ–¥" style="display: none;">
                            <i class="ti ti-x"></i>
                        </button>
                        <button class="input-btn" id="voiceInputBtn" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥">
                            <i class="ti ti-microphone"></i>
                        </button>
                        <button class="input-btn" id="emojiBtn" title="–í—Å—Ç–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏">
                            <i class="ti ti-mood-smile"></i>
                        </button>
                        <button class="send-btn" id="sendBtn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
                            <i class="ti ti-send"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã -->
            <div class="attached-files" id="attachedFiles">
                <!-- Attached files will appear here -->
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –∏ —Ä–µ–∂–∏–º–æ–≤ -->
            <div class="action-buttons">
                <div class="mode-buttons">
                    <button class="action-btn mode-btn active" id="normalModeBtn" data-mode="normal">
                        <i class="ti ti-message"></i>
                        <span class="btn-text">–ß–∞—Ç</span>
                    </button>
                    <button class="action-btn mode-btn" id="creativeModeBtn" data-mode="creative">
                        <i class="ti ti-sparkles"></i>
                        <span class="btn-text">–ö—Ä–µ–∞—Ç–∏–≤</span>
                    </button>
                    <button class="action-btn mode-btn" id="generateVoiceBtn" data-mode="voice">
                        <i class="ti ti-microphone"></i>
                        <span class="btn-text">–ì–æ–ª–æ—Å</span>
                    </button>
                    <button class="action-btn mode-btn" id="generateImageBtn" data-mode="image">
                        <i class="ti ti-photo"></i>
                        <span class="btn-text">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>
                    </button>
                    <button class="action-btn mode-btn" id="codeModeBtn" data-mode="code">
                        <i class="ti ti-code"></i>
                        <span class="btn-text">–ö–æ–¥</span>
                    </button>
                </div>
                
                <div class="utility-buttons">
                    <button class="action-btn" id="helpBtn" title="–ü–æ–º–æ—â—å">
                        <i class="ti ti-help"></i>
                    </button>
                    <button class="action-btn" id="clearChatBtn" title="–û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç">
                        <i class="ti ti-trash"></i>
                    </button>
                    <button class="action-btn" id="exportBtn" title="–≠–∫—Å–ø–æ—Ä—Ç">
                        <i class="ti ti-download"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- –ù–∏–∂–Ω–∏–π –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª -->
        <footer class="app-footer">
            <div class="footer-content">
                <div class="current-chat-info">
                    <i class="ti ti-message"></i>
                    <span id="currentChatName">–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</span>
                    <span class="message-counter" id="footerMessageCount">0</span>
                </div>
                
                <div class="footer-controls">
                    <div class="model-info">
                        <i class="ti ti-brain"></i>
                        <span id="currentModelInfo">GPT-4 Turbo</span>
                    </div>
                    <div class="footer-status" id="footerStatus">
                        <i class="ti ti-circle-check"></i>
                        <span>–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
    <div class="sidebar-menu" id="sidebarMenu">
        <div class="sidebar-header">
            <div class="sidebar-header-content">
                <div class="sidebar-logo">
                    <img src="./logo.png" alt="KHAI Pro" onerror="this.style.display='none'">
                </div>
                <div>
                    <h3>KHAI Pro</h3>
                    <span class="sidebar-subtitle">AI –ß–∞—Ç-–ø–æ–º–æ—â–Ω–∏–∫</span>
                </div>
            </div>
            <button class="sidebar-close" id="sidebarClose">
                <i class="ti ti-x"></i>
            </button>
        </div>

        <div class="sidebar-content">
            <!-- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø -->
            <div class="sidebar-section">
                <h4>
                    <i class="ti ti-rocket"></i>
                    –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
                </h4>
                <div class="quick-access-grid">
                    <button class="quick-access-btn" id="qaNewChat">
                        <i class="ti ti-plus"></i>
                        <span>–ù–æ–≤—ã–π —á–∞—Ç</span>
                    </button>
                    <button class="quick-access-btn" id="qaTemplates">
                        <i class="ti ti-template"></i>
                        <span>–®–∞–±–ª–æ–Ω—ã</span>
                    </button>
                    <button class="quick-access-btn" id="qaSettings">
                        <i class="ti ti-settings"></i>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                    </button>
                    <button class="quick-access-btn" id="qaHelp">
                        <i class="ti ti-help"></i>
                        <span>–ü–æ–º–æ—â—å</span>
                    </button>
                </div>
            </div>

            <!-- –ü–æ–∏—Å–∫ –≤ –∏—Å—Ç–æ—Ä–∏–∏ -->
            <div class="sidebar-section">
                <div class="search-wrapper">
                    <i class="ti ti-search"></i>
                    <input type="text" id="sidebarSearch" placeholder="–ü–æ–∏—Å–∫ –≤ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤...">
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ -->
            <div class="sidebar-section">
                <div class="section-header">
                    <h4>
                        <i class="ti ti-history"></i>
                        –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤
                    </h4>
                    <span class="chats-count" id="chatsCount">0</span>
                </div>
                <div class="chat-list" id="chatList">
                    <!-- Chat items will be loaded here -->
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏ -->
            <div class="chat-management-buttons">
                <button class="sidebar-btn primary" id="newChatBtn">
                    <i class="ti ti-plus"></i>
                    –ù–æ–≤—ã–π —á–∞—Ç
                </button>
                <button class="sidebar-btn" id="importChatBtn">
                    <i class="ti ti-upload"></i>
                    –ò–º–ø–æ—Ä—Ç
                </button>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
            <div class="sidebar-section">
                <h4>
                    <i class="ti ti-info-circle"></i>
                    –û —Å–∏—Å—Ç–µ–º–µ
                </h4>
                <div class="system-info">
                    <div class="info-item">
                        <span class="info-label">–í–µ—Ä—Å–∏—è:</span>
                        <span class="info-value">2.0.0 Pro</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ú–æ–¥–µ–ª—å:</span>
                        <span class="info-value" id="sidebarModelInfo">GPT-4 Turbo</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–°—Ç–∞—Ç—É—Å:</span>
                        <span class="info-value status-online" id="sidebarStatus">‚úÖ –û–Ω–ª–∞–π–Ω</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–°–æ–æ–±—â–µ–Ω–∏—è:</span>
                        <span class="info-value" id="sidebarMessageCount">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è —Å–∞–π–¥–±–∞—Ä–∞ -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    
    <!-- Emoji Picker -->
    <div class="emoji-picker" id="emojiPicker">
        <div class="emoji-categories">
            <button class="emoji-category-btn active" data-category="recent">üïí</button>
            <button class="emoji-category-btn" data-category="smileys">üòÄ</button>
            <button class="emoji-category-btn" data-category="people">üëã</button>
            <button class="emoji-category-btn" data-category="nature">üêª</button>
            <button class="emoji-category-btn" data-category="food">üçï</button>
            <button class="emoji-category-btn" data-category="activities">‚öΩ</button>
            <button class="emoji-category-btn" data-category="objects">üí°</button>
            <button class="emoji-category-btn" data-category="symbols">‚ù§Ô∏è</button>
        </div>
        <div class="emoji-grid" id="emojiGrid">
            <!-- Emojis will be loaded here -->
        </div>
    </div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <!-- Context menu items will be added dynamically -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
